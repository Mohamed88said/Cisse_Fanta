{% extends "base.html" %}
{% block content %}
<div class="header-container">
    <h1>ğŸ“Š Statistiques de notre jardin secret</h1>
    <p>DÃ©couvrez l'Ã©volution de votre histoire d'amour</p>
</div>

<div class="navigation-links">
    <a href="{{ url_for('index') }}" class="btn btn-secondary">â† Retour Ã  l'accueil</a>
</div>

<div class="stats-container">
    <!-- Statistiques gÃ©nÃ©rales -->
    <div class="stats-section">
        <h2>ğŸ“ˆ Vue d'ensemble</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ğŸ’Œ</div>
                <div class="stat-info">
                    <div class="stat-number">{{ total_messages }}</div>
                    <div class="stat-label">Messages d'amour</div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">ğŸ“¸</div>
                <div class="stat-info">
                    <div class="stat-number">{{ total_photos }}</div>
                    <div class="stat-label">Photos partagÃ©es</div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">â­</div>
                <div class="stat-info">
                    <div class="stat-number">{{ favoris_count }}</div>
                    <div class="stat-label">Messages favoris</div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">ğŸ’</div>
                <div class="stat-info">
                    <div class="stat-number">{{ ((total_messages + total_photos) / 30) | round(1) }}</div>
                    <div class="stat-label">Partages par mois</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Messages par utilisateur -->
    <div class="stats-section">
        <h2>ğŸ’Œ Messages par personne</h2>
        <div class="user-stats">
            {% for user_stat in messages_by_user %}
                <div class="user-stat-item">
                    <div class="user-name">{{ user_stat.auteur }}</div>
                    <div class="user-bar">
                        <div class="user-bar-fill" style="width: {{ (user_stat.count / total_messages * 100) if total_messages > 0 else 0 }}%"></div>
                    </div>
                    <div class="user-count">{{ user_stat.count }} messages</div>
                </div>
            {% endfor %}
        </div>
    </div>

    <!-- Photos par utilisateur -->
    {% if photos_by_user %}
    <div class="stats-section">
        <h2>ğŸ“¸ Photos par personne</h2>
        <div class="user-stats">
            {% for user_stat in photos_by_user %}
                <div class="user-stat-item">
                    <div class="user-name">{{ user_stat.auteur }}</div>
                    <div class="user-bar">
                        <div class="user-bar-fill" style="width: {{ (user_stat.count / total_photos * 100) if total_photos > 0 else 0 }}%"></div>
                    </div>
                    <div class="user-count">{{ user_stat.count }} photos</div>
                </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- ActivitÃ© rÃ©cente -->
    <div class="stats-section">
        <h2>ğŸ•’ ActivitÃ© rÃ©cente</h2>
        <div class="activity-list">
            {% for activity in recent_activity %}
                <div class="activity-item">
                    <div class="activity-icon">
                        {% if activity.action == 'login' %}ğŸ”
                        {% elif activity.action == 'message_added' %}ğŸ’Œ
                        {% elif activity.action == 'photo_uploaded' %}ğŸ“¸
                        {% elif activity.action == 'phrase_liked' %}â¤ï¸
                        {% elif activity.action == 'photo_liked' %}â¤ï¸
                        {% elif activity.action == 'mood_checked' %}ğŸŒ·
                        {% elif activity.action == 'search' %}ğŸ”
                        {% else %}ğŸ“
                        {% endif %}
                    </div>
                    <div class="activity-info">
                        <div class="activity-user">{{ activity.user }}</div>
                        <div class="activity-description">
                            {% if activity.action == 'login' %}s'est connectÃ©(e)
                            {% elif activity.action == 'message_added' %}a ajoutÃ© un message
                            {% elif activity.action == 'photo_uploaded' %}a uploadÃ© une photo
                            {% elif activity.action == 'phrase_liked' %}a likÃ© un message
                            {% elif activity.action == 'photo_liked' %}a likÃ© une photo
                            {% elif activity.action == 'mood_checked' %}a vÃ©rifiÃ© son humeur
                            {% elif activity.action == 'search' %}a effectuÃ© une recherche
                            {% else %}{{ activity.action }}
                            {% endif %}
                        </div>
                        {% if activity.details %}
                            <div class="activity-details">{{ activity.details }}</div>
                        {% endif %}
                    </div>
                    <div class="activity-date">{{ activity.date.strftime('%d/%m Ã  %H:%M') }}</div>
                </div>
            {% endfor %}
        </div>
    </div>

    <!-- Messages inspirants -->
    <div class="stats-section">
        <h2>ğŸ’ Votre histoire en chiffres</h2>
        <div class="love-stats">
            <div class="love-stat">
                <p>Vous avez partagÃ© <strong>{{ total_messages + total_photos }}</strong> moments prÃ©cieux ensemble</p>
            </div>
            <div class="love-stat">
                <p>Cela reprÃ©sente <strong>{{ ((total_messages + total_photos) * 2) | round }}</strong> minutes de bonheur partagÃ©</p>
            </div>
            <div class="love-stat">
                <p>Votre amour grandit chaque jour un peu plus ğŸ’•</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}